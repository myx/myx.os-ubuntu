#!/bin/bash

set -e

type UserRequireRoot >/dev/null 2>&1 || \
	. "/usr/local/share/myx.common/bin/user/requireRoot"

InstallUserGroupMembership(){
	UserRequireRoot "InstallUserGroupMembership"

	local NAME="$1"; shift;
	local GROUPS="$@"

	test ! -z "$NAME" || ( echo "InstallUserGroupMembership: username is required!" ; exit 1 )
	if test -z "$GROUPS" ; then
		echo "InstallUserGroupMembership: groupname is taken from username ($NAME)!"
		GROUPS="$NAME"
	fi
	
	
	for GROUP in $GROUPS ; do
		getent group "$GROUP" || groupadd --system "$GROUP"
		# adduser "$NAME" "$GROUP"
		usermod -a -G "$GROUP" "$NAME"
	done
}

case "$0" in
	*/myx.common/bin/lib/installUserGroupMembership) 
		InstallUserGroupMembership "$@"
	;;
esac
